<!DOCTYPE html>
<html lang="zh-TW" xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="x-apple-disable-message-reformatting">
  <title>Business Card Scanner</title>
  
  <!-- SheetJS CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  
  <style>
    * {
      box-sizing: border-box;
    }
    
    table, td, div, h1, h2, p, button, input {
      font-family: "Microsoft JhengHei", Arial, sans-serif;
    }
    
    body {
      margin: 0;
      padding: 0;
      background-color: #e3e3e3;
    }
    
    .container {
      width: 94%;
      max-width: 600px;
      margin: 0 auto;
      background-color: #ffffff;
    }
    
    .header {
      padding: 20px;
      text-align: center;
      background-color: #ffffff;
      border-bottom: 2px solid #f0f0f0;
      position: relative;
    }
    
    .header img {
      width: 200px;
      max-width: 80%;
      height: auto;
    }
    
    .header h1 {
      margin: 10px 0 0 0;
      font-size: 22px;
      line-height: 28px;
      font-weight: bold;
      color: #363636;
    }
    
    .language-selector {
      position: absolute;
      top: 20px;
      right: 20px;
      z-index: 100;
    }
    
    .language-selector select {
      padding: 8px 12px;
      font-size: 14px;
      font-weight: bold;
      border: 2px solid #0066cc;
      border-radius: 6px;
      background-color: #ffffff;
      color: #0066cc;
      cursor: pointer;
      font-family: "Microsoft JhengHei", Arial, sans-serif;
    }
    
    .language-selector select:hover {
      background-color: #f0f7ff;
    }
    
    .language-selector select:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.2);
    }
    
    .content {
      padding: 20px;
    }
    
    .preview-box {
      width: 100%;
      height: 250px;
      border: 2px dashed #cccccc;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #f9f9f9;
      margin-bottom: 15px;
      overflow: hidden;
      position: relative;
    }

    .preview-box:hover {
      border-color: #0066cc;
      background-color: #f0f7ff;
    }
    
    .preview-box img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }
    
    .preview-placeholder {
      text-align: center;
      color: #999999;
    }
    
    .preview-placeholder svg {
      width: 60px;
      height: 60px;
      margin-bottom: 10px;
      opacity: 0.5;
    }
    
    .button-group {
      display: flex;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .btn {
      flex: 1;
      padding: 14px 20px;
      font-size: 16px;
      font-weight: bold;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .btn:active {
      transform: scale(0.98);
    }
    
    .btn-primary {
      background-color: #0066cc;
      color: white;
    }
    
    .btn-primary:hover {
      background-color: #0052a3;
    }
    
    .btn-primary:disabled {
      background-color: #cccccc;
      cursor: not-allowed;
    }
    
    .btn-secondary {
      background-color: #6c757d;
      color: white;
    }
    
    .btn-secondary:hover {
      background-color: #5a6268;
    }
    
    .btn-success {
      background-color: #28a745;
      color: white;
    }
    
    .btn-success:hover {
      background-color: #218838;
    }
    
    .btn-large {
      width: 100%;
      padding: 16px;
      font-size: 18px;
    }
    
    .form-section {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 2px solid #f0f0f0;
    }
    
    .form-title {
      font-size: 20px;
      font-weight: bold;
      color: #363636;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-label {
      display: block;
      font-size: 14px;
      font-weight: bold;
      color: #555555;
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .form-input {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border: 1px solid #cccccc;
      border-radius: 6px;
      font-family: "Microsoft JhengHei", Arial, sans-serif;
    }
    
    .form-input:focus {
      outline: none;
      border-color: #0066cc;
      box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
    }
    

    
    .footer {
      padding: 20px;
      text-align: center;
      font-size: 12px;
      background-color: #404040;
      color: #cccccc;
    }
    
    .footer p {
      margin: 0;
      font-size: 14px;
      line-height: 20px;
    }
    
    .loading {
      display: none;
      text-align: center;
      padding: 15px;
      background-color: #fff3cd;
      border: 1px solid #ffc107;
      border-radius: 6px;
      margin-bottom: 15px;
      color: #856404;
    }
    
    .loading.show {
      display: block;
    }
    
    .alert {
      display: none;
      padding: 12px 15px;
      border-radius: 6px;
      margin-bottom: 15px;
      font-size: 14px;
    }
    
    .alert.show {
      display: block;
    }
    
    .alert-success {
      background-color: #d4edda;
      border: 1px solid #c3e6cb;
      color: #155724;
    }
    
    .alert-error {
      background-color: #f8d7da;
      border: 1px solid #f5c6cb;
      color: #721c24;
    }
    
    input[type="file"] {
      display: none;
    }
    
    @media screen and (max-width: 480px) {
      .header h1 {
        font-size: 18px;
      }
      
      .language-selector {
        position: static;
        margin-bottom: 10px;
      }
      
      .language-selector select {
        font-size: 12px;
        padding: 6px 10px;
      }
      
      .btn {
        font-size: 14px;
        padding: 12px 16px;
      }
      
      .btn-large {
        font-size: 16px;
        padding: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="language-selector">
        <select id="languageSelect" onchange="changeLanguage()">
          <option value="en">English</option>
          <option value="de">Deutsch</option>
          <option value="nl">Nederlands</option>
          <option value="jp">æ—¥æœ¬èª</option>
          <option value="kr">í•œêµ­ì–´</option>
          <option value="sc">ç®€ä½“ä¸­æ–‡</option>
          <option value="tc">ç¹é«”ä¸­æ–‡</option>
        </select>
      </div>
      <img src="https://www.transcend-info.com/images/ts_logo.png" alt="TranscendLogo">
      <h1 id="headerTitle">Business Name Card Scanner</h1>
    </div>
    
    <!-- Content -->
    <div class="content">
      <!-- Alert Messages -->
      <div id="alertSuccess" class="alert alert-success"></div>
      <div id="alertError" class="alert alert-error"></div>
      <div id="loadingDiv" class="loading">
        <p id="loadingText"> Scanning business card, please wait...</p>
        <p id="progressText" style="margin-top: 5px; font-size: 12px;">Loading...</p>
      </div>
      
      <!-- Preview Box -->
      <div class="preview-box" id="previewBox" onclick="document.getElementById('fileInput').click()">
        <div class="preview-placeholder">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
          <p id="previewText">Click to upload a business card</p>
        </div>
      </div>
      
      <!-- Action Buttons -->
      <div class="button-group">
        <button class="btn btn-primary" onclick="openCamera()">
          <span id="btnCamera">ğŸ“· Camera</span>
        </button>
      </div>
      
      <input type="file" id="fileInput" accept="image/*" onchange="handleFileSelect(event)">
      <input type="file" id="cameraInput" accept="image/*" capture="environment" onchange="handleFileSelect(event)">
      
      <!-- Form Section -->
      <div class="form-section">
        <div class="form-title" id="formTitle">ğŸ“ Scan Results</div>
        
        <div class="form-group">
          <label class="form-label" id="labelName">ğŸ‘¤ Name</label>
          <input type="text" class="form-input" id="nameInput">
        </div>
        
        <div class="form-group">
          <label class="form-label" id="labelJobTitle">ğŸ’¼ Job Title</label>
          <input type="text" class="form-input" id="jobTitleInput">
        </div>
        
        <div class="form-group">
          <label class="form-label" id="labelDepartment">ğŸ›ï¸ Department</label>
          <input type="text" class="form-input" id="departmentInput">
        </div>
        
        <div class="form-group">
          <label class="form-label" id="labelPhone">ğŸ“ Phone</label>
          <input type="text" class="form-input" id="phoneInput">
        </div>
        
        <div class="form-group">
          <label class="form-label" id="labelFax">ğŸ“  Fax</label>
          <input type="text" class="form-input" id="faxInput">
        </div>
        
        <div class="form-group">
          <label class="form-label" id="labelEmail">âœ‰ï¸ Email</label>
          <input type="email" class="form-input" id="emailInput">
        </div>
        
        <div class="form-group">
          <label class="form-label" id="labelCompany">ğŸ¢ Company Name</label>
          <input type="text" class="form-input" id="companyInput">
        </div>
        
        <div class="form-group">
          <label class="form-label" id="labelAddress">ğŸ“ Company Address</label>
          <input type="text" class="form-input" id="addressInput">
        </div>
        
        <div class="form-group">
          <label class="form-label" id="labelWebsite">ğŸŒ Company Website</label>
          <input type="url" class="form-input" id="websiteInput">
        </div>
        
        <div class="form-group" id="taxIdField" style="display: none;">
          <label class="form-label" id="labelTaxId"> çµ±ä¸€ç·¨è™Ÿ </label>
          <input type="text" class="form-input" id="taxIdInput">
        </div>
        
        <!-- Action Buttons -->
        <button class="btn btn-primary btn-large" onclick="uploadNew()" style="margin-bottom: 10px;">
          <span id="btnUploadNew">ğŸ“ Upload New Card</span>
        </button>
        
        <button class="btn btn-secondary btn-large" onclick="rescan()" style="margin-bottom: 10px;">
          <span id="btnRescan">ğŸ”„ Rescan</span>
        </button>
        
        <button class="btn btn-success btn-large" onclick="exportToExcel()">
          <span id="btnExport">ğŸ“¥ Export to Excel</span>
        </button>
      </div>
    </div>
    
    <!-- Footer -->
    <div class="footer">
      <p>Copyright Â© Transcend Information, Inc. All Rights Reserved.</p>
    </div>
  </div>
  
  <script>
    let currentImage = null;
    let currentImageFile = null;
    let currentLanguage = 'en';
    
    // Azure AI Vision Configuration 
    const AZURE_ENDPOINT_ENCODED = 'aHR0cHM6Ly9qYXBhbmVhc3QuYXBpLmNvZ25pdGl2ZS5taWNyb3NvZnQuY29tLw==';
    const AZURE_API_KEY_ENCODED = 'Y2JiNTYxYjhiMTRiNDZhMDljYjQ4MjNjNDFkNGIzY2Y=';
    
    // Decode credentials
    const AZURE_ENDPOINT = atob(AZURE_ENDPOINT_ENCODED);
    const AZURE_API_KEY = atob(AZURE_API_KEY_ENCODED);
    
    const translations = {
      en: {
        title: 'Transcend Business Name Card Scanner',
        previewText: 'Click to upload a business card',
        btnCamera: 'ğŸ“· Camera',
        loadingText: 'ğŸ” Scanning business card, please wait...',
        progressText: 'Loading...',
        formTitle: 'ğŸ“ Scan Results',
        labelName: 'ğŸ‘¤ Name',
        labelJobTitle: 'ğŸ’¼ Job Title',
        labelDepartment: 'ğŸ›ï¸ Department',
        labelPhone: 'ğŸ“ Phone',
        labelFax: 'ğŸ“  Fax',
        labelEmail: 'âœ‰ï¸ Email',
        labelCompany: 'ğŸ¢ Company',
        labelAddress: 'ğŸ“ Company Address',
        labelWebsite: 'ğŸŒ Company Website',
        labelTaxId: 'ğŸ”¢ Tax ID',
        btnUploadNew: 'ğŸ“ Upload New Card',
        btnRescan: 'ğŸ”„ Rescan',
        btnExport: 'ğŸ“¥ Export to Excel',
        alertImageLoaded: 'âœ… Image loaded',
        alertUploadFirst: 'âŒ Please upload an image first',
        alertNoAzureConfig: 'âŒ Please configure Azure AI Vision credentials first',
        alertScanComplete: 'âœ… Scan completed! Please check and correct the data',
        alertScanFailed: 'âŒ Scan failed: ',
        alertNoImage: 'âŒ No image to rescan',
        alertFillField: 'âŒ Please fill in at least one field',
        alertExcelDownloaded: 'âœ… Excel file downloaded: ',
        confirmUploadNew: 'Are you sure you want to upload a new card? Current data will be cleared.',
        confirmRescan: 'Are you sure you want to rescan? Recognition results will be overwritten.',
        scanProgress: 'Scanning progress: '
      },
      de: {
        title: 'Transcend Visitenkarten-Scanner',
        previewText: 'Klicken Sie hier, um eine Visitenkarte hochzuladen',
        btnCamera: 'ğŸ“· Kamera',
        loadingText: 'ğŸ” Visitenkarte wird gescannt, bitte warten...',
        progressText: 'Wird geladen...',
        formTitle: 'ğŸ“ Scanergebnisse',
        labelName: 'ğŸ‘¤ Name',
        labelJobTitle: 'ğŸ’¼ Berufsbezeichnung',
        labelDepartment: 'ğŸ›ï¸ Abteilung',
        labelPhone: 'ğŸ“ Telefon',
        labelFax: 'ğŸ“  Fax',
        labelEmail: 'âœ‰ï¸ E-Mail',
        labelCompany: 'ğŸ¢ Firma',
        labelAddress: 'ğŸ“ Firmenadresse',
        labelWebsite: 'ğŸŒ Webseite',
        labelTaxId: 'ğŸ”¢ Steuernummer',
        btnUploadNew: 'ğŸ“ Neue Karte hochladen',
        btnRescan: 'ğŸ”„ Neu scannen',
        btnExport: 'ğŸ“¥ Nach Excel exportieren',
        alertImageLoaded: 'âœ… Bild geladen."',
        alertUploadFirst: 'âŒ Bitte laden Sie zuerst ein Bild hoch',
        alertNoAzureConfig: 'âŒ Bitte konfigurieren Sie zuerst die Azure AI Vision-Anmeldeinformationen',
        alertScanComplete: 'âœ… Scan abgeschlossen! Bitte Ã¼berprÃ¼fen und korrigieren Sie die Daten',
        alertScanFailed: 'âŒ Scan fehlgeschlagen: ',
        alertNoImage: 'âŒ Kein Bild zum erneuten Scannen',
        alertFillField: 'âŒ Bitte fÃ¼llen Sie mindestens ein Feld aus',
        alertExcelDownloaded: 'âœ… Excel-Datei heruntergeladen: ',
        confirmUploadNew: 'MÃ¶chten Sie wirklich eine neue Karte hochladen? Aktuelle Daten werden gelÃ¶scht.',
        confirmRescan: 'MÃ¶chten Sie wirklich neu scannen? Erkennungsergebnisse werden Ã¼berschrieben.',
        scanProgress: 'Scan-Fortschritt: '
      },
      nl: {
        title: 'Transcend Visitekaartje Scanner',
        previewText: 'Klik om een visitekaartje te uploaden',
        btnCamera: 'ğŸ“· Camera',
        loadingText: 'ğŸ” Visitekaartje wordt gescand, even geduld...',
        progressText: 'Laden...',
        formTitle: 'ğŸ“ Scanresultaten',
        labelName: 'ğŸ‘¤ Naam',
        labelJobTitle: 'ğŸ’¼ Functietitel',
        labelDepartment: 'ğŸ›ï¸ Afdeling',
        labelPhone: 'ğŸ“ Telefoon',
        labelFax: 'ğŸ“  Fax',
        labelEmail: 'âœ‰ï¸ E-mail',
        labelCompany: 'ğŸ¢ Bedrijf',
        labelAddress: 'ğŸ“ Bedrijfsadres',
        labelWebsite: 'ğŸŒ Website',
        labelTaxId: 'ğŸ”¢ BTW-nummer',
        btnUploadNew: 'ğŸ“ Nieuwe kaart uploaden',
        btnRescan: 'ğŸ”„ Opnieuw scannen',
        btnExport: 'ğŸ“¥ Exporteren naar Excel',
        alertImageLoaded: 'âœ… Afbeelding geladen."',
        alertUploadFirst: 'âŒ Upload eerst een afbeelding',
        alertNoAzureConfig: 'âŒ Configureer eerst de Azure AI Vision-referenties',
        alertScanComplete: 'âœ… Scan voltooid! Controleer en corrigeer de gegevens',
        alertScanFailed: 'âŒ Scan mislukt: ',
        alertNoImage: 'âŒ Geen afbeelding om opnieuw te scannen',
        alertFillField: 'âŒ Vul minimaal Ã©Ã©n veld in',
        alertExcelDownloaded: 'âœ… Excel-bestand gedownload: ',
        confirmUploadNew: 'Weet u zeker dat u een nieuwe kaart wilt uploaden? Huidige gegevens worden gewist.',
        confirmRescan: 'Weet u zeker dat u opnieuw wilt scannen? Herkenningsresultaten worden overschreven.',
        scanProgress: 'Scanvoortgang: '
      },
      jp: {
        title: 'Transcend ååˆºã‚¹ã‚­ãƒ£ãƒŠãƒ¼',
        previewText: 'ã‚¯ãƒªãƒƒã‚¯ã—ã¦ååˆºã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰',
        btnCamera: 'ğŸ“· ã‚«ãƒ¡ãƒ©',
        loadingText: 'ğŸ” ååˆºã‚’ã‚¹ã‚­ãƒ£ãƒ³ä¸­ã§ã™ã€‚ãŠå¾…ã¡ãã ã•ã„...',
        progressText: 'èª­ã¿è¾¼ã¿ä¸­...',
        formTitle: 'ğŸ“ ã‚¹ã‚­ãƒ£ãƒ³çµæœ',
        labelName: 'ğŸ‘¤ åå‰',
        labelJobTitle: 'ğŸ’¼ å½¹è·',
        labelDepartment: 'ğŸ›ï¸ éƒ¨ç½²',
        labelPhone: 'ğŸ“ é›»è©±ç•ªå·',
        labelFax: 'ğŸ“  FAX',
        labelEmail: 'âœ‰ï¸ ãƒ¡ãƒ¼ãƒ«',
        labelCompany: 'ğŸ¢ ä¼šç¤¾',
        labelAddress: 'ğŸ“ ä¼šç¤¾ä½æ‰€',
        labelWebsite: 'ğŸŒ ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ',
        labelTaxId: 'ğŸ”¢ æ³•äººç•ªå·',
        btnUploadNew: 'ğŸ“ æ–°ã—ã„ååˆºã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰',
        btnRescan: 'ğŸ”„ å†ã‚¹ã‚­ãƒ£ãƒ³',
        btnExport: 'ğŸ“¥ Excelã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ',
        alertImageLoaded: 'âœ… ç”»åƒãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸã€‚',
        alertUploadFirst: 'âŒ æœ€åˆã«ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„',
        alertNoAzureConfig: 'âŒ ã¾ãšAzure AI Visionã®èªè¨¼æƒ…å ±ã‚’è¨­å®šã—ã¦ãã ã•ã„',
        alertScanComplete: 'âœ… ã‚¹ã‚­ãƒ£ãƒ³å®Œäº†ï¼ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªã—ã¦ä¿®æ­£ã—ã¦ãã ã•ã„',
        alertScanFailed: 'âŒ ã‚¹ã‚­ãƒ£ãƒ³å¤±æ•—: ',
        alertNoImage: 'âŒ å†ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ç”»åƒãŒã‚ã‚Šã¾ã›ã‚“',
        alertFillField: 'âŒ å°‘ãªãã¨ã‚‚1ã¤ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
        alertExcelDownloaded: 'âœ… Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸ: ',
        confirmUploadNew: 'æ–°ã—ã„ååˆºã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã¯ã‚¯ãƒªã‚¢ã•ã‚Œã¾ã™ã€‚',
        confirmRescan: 'å†ã‚¹ã‚­ãƒ£ãƒ³ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿèªè­˜çµæœã¯ä¸Šæ›¸ãã•ã‚Œã¾ã™ã€‚',
        scanProgress: 'ã‚¹ã‚­ãƒ£ãƒ³é€²è¡ŒçŠ¶æ³: '
      },
      kr: {
        title: 'Transcend ëª…í•¨ ìŠ¤ìºë„ˆ',
        previewText: 'í´ë¦­í•˜ì—¬ ëª…í•¨ ì—…ë¡œë“œ',
        btnCamera: 'ğŸ“· ì¹´ë©”ë¼',
        loadingText: 'ğŸ” ëª…í•¨ì„ ìŠ¤ìº”í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...',
        progressText: 'ë¡œë”© ì¤‘...',
        formTitle: 'ğŸ“ ìŠ¤ìº” ê²°ê³¼',
        labelName: 'ğŸ‘¤ ì´ë¦„',
        labelJobTitle: 'ğŸ’¼ ì§ì±…',
        labelDepartment: 'ğŸ›ï¸ ë¶€ì„œ',
        labelPhone: 'ğŸ“ ì „í™”ë²ˆí˜¸',
        labelFax: 'ğŸ“  íŒ©ìŠ¤',
        labelEmail: 'âœ‰ï¸ ì´ë©”ì¼',
        labelCompany: 'ğŸ¢ íšŒì‚¬',
        labelAddress: 'ğŸ“ íšŒì‚¬ ì£¼ì†Œ',
        labelWebsite: 'ğŸŒ ì›¹ì‚¬ì´íŠ¸',
        labelTaxId: 'ğŸ”¢ ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸',
        btnUploadNew: 'ğŸ“ ìƒˆ ëª…í•¨ ì—…ë¡œë“œ',
        btnRescan: 'ğŸ”„ ë‹¤ì‹œ ìŠ¤ìº”',
        btnExport: 'ğŸ“¥ Excelë¡œ ë‚´ë³´ë‚´ê¸°',
        alertImageLoaded: 'âœ… ì´ë¯¸ì§€ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.',
        alertUploadFirst: 'âŒ ë¨¼ì € ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”',
        alertNoAzureConfig: 'âŒ ë¨¼ì € Azure AI Vision ìê²© ì¦ëª…ì„ êµ¬ì„±í•˜ì„¸ìš”',
        alertScanComplete: 'âœ… ìŠ¤ìº” ì™„ë£Œ! ë°ì´í„°ë¥¼ í™•ì¸í•˜ê³  ìˆ˜ì •í•˜ì„¸ìš”',
        alertScanFailed: 'âŒ ìŠ¤ìº” ì‹¤íŒ¨: ',
        alertNoImage: 'âŒ ë‹¤ì‹œ ìŠ¤ìº”í•  ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤',
        alertFillField: 'âŒ ìµœì†Œí•œ í•˜ë‚˜ì˜ í•„ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”',
        alertExcelDownloaded: 'âœ… Excel íŒŒì¼ ë‹¤ìš´ë¡œë“œë¨: ',
        confirmUploadNew: 'ìƒˆ ëª…í•¨ì„ ì—…ë¡œë“œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? í˜„ì¬ ë°ì´í„°ê°€ ì§€ì›Œì§‘ë‹ˆë‹¤.',
        confirmRescan: 'ë‹¤ì‹œ ìŠ¤ìº”í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì¸ì‹ ê²°ê³¼ê°€ ë®ì–´ì“°ê¸°ë©ë‹ˆë‹¤.',
        scanProgress: 'ìŠ¤ìº” ì§„í–‰ë¥ : '
      },
      sc: {
        title: 'Transcend åç‰‡æ‰«æå·¥å…·',
        previewText: 'ç‚¹å‡»ä¸Šä¼ åç‰‡',
        btnCamera: 'ğŸ“· æ‹ç…§',
        loadingText: 'ğŸ” æ­£åœ¨è¯†åˆ«åç‰‡ï¼Œè¯·ç¨å€™...',
        progressText: 'åŠ è½½ä¸­...',
        formTitle: 'ğŸ“ è¯†åˆ«ç»“æœ',
        labelName: 'ğŸ‘¤ å§“å',
        labelJobTitle: 'ğŸ’¼ èŒä½',
        labelDepartment: 'ğŸ›ï¸ éƒ¨é—¨',
        labelPhone: 'ğŸ“ ç”µè¯',
        labelFax: 'ğŸ“  ä¼ çœŸ',
        labelEmail: 'âœ‰ï¸ é‚®ç®±',
        labelCompany: 'ğŸ¢ å…¬å¸',
        labelAddress: 'ğŸ“ å…¬å¸åœ°å€',
        labelWebsite: 'ğŸŒ å…¬å¸ç½‘ç«™',
        labelTaxId: 'ğŸ”¢ ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ',
        btnUploadNew: 'ğŸ“ ä¸Šä¼ æ–°åç‰‡',
        btnRescan: 'ğŸ”„ é‡æ–°æ‰«æ',
        btnExport: 'ğŸ“¥ å¯¼å‡ºExcel',
        alertImageLoaded: 'âœ… å›¾ç‰‡å·²åŠ è½½,
        alertUploadFirst: 'âŒ è¯·å…ˆä¸Šä¼ å›¾ç‰‡',
        alertNoAzureConfig: 'âŒ è¯·å…ˆé…ç½®Azure AI Visionå‡­æ®',
        alertScanComplete: 'âœ… è¯†åˆ«å®Œæˆï¼è¯·æ£€æŸ¥å¹¶ä¿®æ­£æ•°æ®',
        alertScanFailed: 'âŒ è¯†åˆ«å¤±è´¥ï¼š',
        alertNoImage: 'âŒ æ²¡æœ‰å¯é‡æ–°æ‰«æçš„å›¾ç‰‡',
        alertFillField: 'âŒ è¯·è‡³å°‘å¡«å†™ä¸€ä¸ªå­—æ®µ',
        alertExcelDownloaded: 'âœ… Excelæ–‡ä»¶å·²ä¸‹è½½ï¼š',
        confirmUploadNew: 'ç¡®å®šè¦ä¸Šä¼ æ–°åç‰‡å—ï¼Ÿå½“å‰æ•°æ®å°†è¢«æ¸…ç©ºã€‚',
        confirmRescan: 'ç¡®å®šè¦é‡æ–°æ‰«æå—ï¼Ÿè¯†åˆ«ç»“æœå°†è¢«è¦†ç›–ã€‚',
        scanProgress: 'è¯†åˆ«è¿›åº¦ï¼š'
      },
      tc: {
        title: 'Transcend åç‰‡æƒæå·¥å…·',
        previewText: 'é»æ“Šä¸Šå‚³åç‰‡',
        btnCamera: 'ğŸ“· æ‹ç…§',
        loadingText: 'ğŸ” æ­£åœ¨è¾¨è­˜åç‰‡ï¼Œè«‹ç¨å€™...',
        progressText: 'è¼‰å…¥ä¸­...',
        formTitle: 'ğŸ“ è¾¨è­˜çµæœ',
        labelName: 'ğŸ‘¤ å§“å',
        labelJobTitle: 'ğŸ’¼ è·ç¨±',
        labelDepartment: 'ğŸ›ï¸ éƒ¨é–€',
        labelPhone: 'ğŸ“ é›»è©±',
        labelFax: 'ğŸ“  å‚³çœŸ',
        labelEmail: 'âœ‰ï¸ é›»å­éƒµä»¶',
        labelCompany: 'ğŸ¢ å…¬å¸',
        labelAddress: 'ğŸ“ å…¬å¸åœ°å€',
        labelWebsite: 'ğŸŒ å…¬å¸ç¶²ç«™',
        labelTaxId: 'ğŸ”¢ çµ±ä¸€ç·¨è™Ÿ',
        btnUploadNew: 'ğŸ“ ä¸Šå‚³æ–°åç‰‡',
        btnRescan: 'ğŸ”„ é‡æ–°æƒæ',
        btnExport: 'ğŸ“¥ åŒ¯å‡ºExcel',
        alertImageLoaded: 'âœ… åœ–ç‰‡å·²è¼‰å…¥',
        alertUploadFirst: 'âŒ è«‹å…ˆä¸Šå‚³åœ–ç‰‡',
        alertNoAzureConfig: 'âŒ è«‹å…ˆè¨­å®šAzure AI Visionæ†‘è­‰',
        alertScanComplete: 'âœ… è¾¨è­˜å®Œæˆï¼è«‹æª¢æŸ¥ä¸¦ä¿®æ­£è³‡æ–™',
        alertScanFailed: 'âŒ è¾¨è­˜å¤±æ•—ï¼š',
        alertNoImage: 'âŒ æ²’æœ‰å¯é‡æ–°æƒæçš„åœ–ç‰‡',
        alertFillField: 'âŒ è«‹è‡³å°‘å¡«å¯«ä¸€å€‹æ¬„ä½',
        alertExcelDownloaded: 'âœ… Excelæª”æ¡ˆå·²ä¸‹è¼‰ï¼š',
        confirmUploadNew: 'ç¢ºå®šè¦ä¸Šå‚³æ–°åç‰‡å—ï¼Ÿç›®å‰çš„è³‡æ–™å°‡è¢«æ¸…ç©ºã€‚',
        confirmRescan: 'ç¢ºå®šè¦é‡æ–°æƒæå—ï¼Ÿè¾¨è­˜çµæœå°‡è¢«è¦†è“‹ã€‚',
        scanProgress: 'è¾¨è­˜é€²åº¦ï¼š'
      }
    };
    
    function changeLanguage() {
      const lang = document.getElementById('languageSelect').value;
      currentLanguage = lang;
      const t = translations[lang];
      
      document.getElementById('headerTitle').textContent = t.title;
      document.getElementById('btnCamera').textContent = t.btnCamera;
      document.getElementById('loadingText').textContent = t.loadingText;
      document.getElementById('formTitle').textContent = t.formTitle;
      document.getElementById('labelName').textContent = t.labelName;
      document.getElementById('labelJobTitle').textContent = t.labelJobTitle;
      document.getElementById('labelDepartment').textContent = t.labelDepartment;
      document.getElementById('labelPhone').textContent = t.labelPhone;
      document.getElementById('labelFax').textContent = t.labelFax;
      document.getElementById('labelEmail').textContent = t.labelEmail;
      document.getElementById('labelCompany').textContent = t.labelCompany;
      document.getElementById('labelAddress').textContent = t.labelAddress;
      document.getElementById('labelWebsite').textContent = t.labelWebsite;
      document.getElementById('labelTaxId').textContent = t.labelTaxId;
      document.getElementById('btnUploadNew').textContent = t.btnUploadNew;
      document.getElementById('btnRescan').textContent = t.btnRescan;
      document.getElementById('btnExport').textContent = t.btnExport;

      // Show/hide Tax ID field based on language
      const taxIdField = document.getElementById('taxIdField');
      if (lang === 'tc') {
        taxIdField.style.display = 'block';
      } else {
        taxIdField.style.display = 'none';
      }
      
      // Update preview text if no image loaded
      if (!currentImage) {
        const previewBox = document.getElementById('previewBox');
        if (previewBox.querySelector('.preview-placeholder')) {
          previewBox.querySelector('p').textContent = t.previewText;
        }
      }
    }
    
    function openCamera() {
      document.getElementById('cameraInput').click();
    }
    
    function handleFileSelect(event) {
      const file = event.target.files[0];
      if (!file) return;
      
      currentImageFile = file;
      
      const reader = new FileReader();
      reader.onload = function(e) {
        currentImage = e.target.result;
        displayImage(currentImage);
        showAlert('success', translations[currentLanguage].alertImageLoaded);

        // Automatically start OCR after image is loaded
        setTimeout(() => {
          performOCR();
        }, 500);
      };
      reader.readAsDataURL(file);
    }
    
    function displayImage(imageSrc) {
      const previewBox = document.getElementById('previewBox');
      previewBox.innerHTML = `<img src="${imageSrc}" alt="Business Card Preview">`;
    }
    
    async function performOCR() {
      if (!currentImage) {
        showAlert('error', translations[currentLanguage].alertUploadFirst);
        return;
      }
      
      // Check if Azure credentials are configured
      if (!AZURE_ENDPOINT || AZURE_ENDPOINT === 'https://your-resource.cognitiveservices.azure.com/' || 
          !AZURE_API_KEY || AZURE_API_KEY === 'your-api-key-here') {
        showAlert('error', translations[currentLanguage].alertNoAzureConfig);
        return;
      }
      
      const loadingDiv = document.getElementById('loadingDiv');
      const progressText = document.getElementById('progressText');
      loadingDiv.classList.add('show');
      progressText.textContent = translations[currentLanguage].progressText;
      
      try {
        // Convert base64 to blob
        const base64Data = currentImage.split(',')[1];
        const byteCharacters = atob(base64Data);
        const byteNumbers = new Array(byteCharacters.length);
        for (let i = 0; i < byteCharacters.length; i++) {
          byteNumbers[i] = byteCharacters.charCodeAt(i);
        }
        const byteArray = new Uint8Array(byteNumbers);
        const blob = new Blob([byteArray], { type: 'image/jpeg' });
        
        // Azure AI Vision API endpoint
        const apiUrl = `${AZURE_ENDPOINT.replace(/\/$/, '')}/vision/v3.2/read/analyze`;
        
        // Submit image for analysis
        const submitResponse = await fetch(apiUrl, {
          method: 'POST',
          headers: {
            'Ocp-Apim-Subscription-Key': AZURE_API_KEY,
            'Content-Type': 'application/octet-stream'
          },
          body: blob
        });
        
        if (!submitResponse.ok) {
          throw new Error(`Azure API error: ${submitResponse.status} ${submitResponse.statusText}`);
        }
        
        // Get operation location from response headers
        const operationLocation = submitResponse.headers.get('Operation-Location');
        if (!operationLocation) {
          throw new Error('No Operation-Location header in response');
        }
        
        // Poll for results
        let result;
        let attempts = 0;
        const maxAttempts = 30;
        
        while (attempts < maxAttempts) {
          await new Promise(resolve => setTimeout(resolve, 1000));
          
          const resultResponse = await fetch(operationLocation, {
            method: 'GET',
            headers: {
              'Ocp-Apim-Subscription-Key': AZURE_API_KEY
            }
          });
          
          if (!resultResponse.ok) {
            throw new Error(`Failed to get results: ${resultResponse.status}`);
          }
          
          result = await resultResponse.json();
          
          if (result.status === 'succeeded') {
            break;
          } else if (result.status === 'failed') {
            throw new Error('OCR analysis failed');
          }
          
          attempts++;
          progressText.textContent = `${translations[currentLanguage].progressText} (${attempts}/${maxAttempts})`;
        }
        
        if (result.status !== 'succeeded') {
          throw new Error('OCR timeout');
        }
        
        // Extract text from results
        let extractedText = '';
        if (result.analyzeResult && result.analyzeResult.readResults) {
          for (const page of result.analyzeResult.readResults) {
            for (const line of page.lines) {
              extractedText += line.text + '\n';
            }
          }
        }
        
        parseOCRResult(extractedText);
        
        loadingDiv.classList.remove('show');
        showAlert('success', translations[currentLanguage].alertScanComplete);
      } catch (error) {
        loadingDiv.classList.remove('show');
        showAlert('error', translations[currentLanguage].alertScanFailed + error.message);
      }
    }

    function guessName(lines) {
    // å®šç¾©è¦æ’é™¤çš„é—œéµå­— (å…¬å¸å¾Œç¶´ã€åœ°å€é—œéµå­—ã€ç¶²ç«™å‰ç¶´)
    const excludeKeywords = [
        'å…¬å¸', 'æœ‰é™å…¬å¸', 'Inc', 'Ltd', 'Corp', 
        'è·¯', 'è™Ÿ', 'æ¨“', 'å®¤', 'å€', 'City', 'Street', 'Road', 
        'Tel', 'Fax', 'Mobile', 'www', 'http', '.com', '.tw'
    ];

    // å®šç¾©å¸¸è¦‹è·ç¨± (ç”¨ä¾†å¾åŒä¸€è¡Œä¸­ç§»é™¤ï¼Œæˆ–æ’é™¤è©²è¡Œ)
    const jobTitles = [
        'ç¶“ç†', 'å‰¯ç†', 'ç¸½ç›£', 'ä¸»ä»»', 'å°ˆå“¡', 'å·¥ç¨‹å¸«', 'åŸ·è¡Œé•·', 'CEO', 'CTO', 'Manager', 'Director', 'Engineer', 'President'
    ];

    // éæ­·æ¯ä¸€è¡Œæ–‡å­—
    for (let i = 0; i < lines.length; i++) {
        let line = lines[i].trim();

        // 1. åŸºæœ¬éæ¿¾ï¼šå¤ªçŸ­ã€åŒ…å« @ã€åŒ…å«æ•¸å­— (åå­—é€šå¸¸æ²’æ•¸å­—)
        if (line.length < 2 || line.includes('@') || /\d/.test(line)) {
            continue;
        }

        // 2. æ’é™¤é—œéµå­—éæ¿¾ (å¦‚æœæœ‰å…¬å¸æˆ–åœ°å€é—œéµå­—ï¼Œå°±è·³é)
        if (excludeKeywords.some(keyword => line.toLowerCase().includes(keyword.toLowerCase()))) {
            continue;
        }

        // 3. è·ç¨±è™•ç† (é‡é ­æˆ²)
        // æª¢æŸ¥é€™ä¸€è¡Œæ˜¯å¦åŒ…å«è·ç¨±
        const matchedTitle = jobTitles.find(title => line.toLowerCase().includes(title.toLowerCase()));
        
        if (matchedTitle) {
            // å¦‚æœé€™è¡ŒåŒ…å«è·ç¨±ï¼Œå˜—è©¦æŠŠè·ç¨±ç§»é™¤ï¼Œå‰©ä¸‹çš„å¯èƒ½æ˜¯åå­—
            // ä¾‹å¦‚ï¼š"ç‹å°æ˜ ç¶“ç†" -> ç§»é™¤ "ç¶“ç†" -> ç•™ä¸‹ "ç‹å°æ˜"
            let possibleName = line.replace(matchedTitle, '').trim();
            // ç§»é™¤å¯èƒ½æ®˜ç•™çš„æ¨™é»ç¬¦è™Ÿæˆ–ç©ºæ ¼
            possibleName = possibleName.replace(/[\|\-,\.]/g, '').trim();
            
            if (possibleName.length > 1 && possibleName.length < 10) {
                return possibleName; // æ‰¾åˆ°åå­—ï¼Œç›´æ¥å›å‚³
            }
        } else {
            // 4. å¦‚æœæ²’æœ‰è·ç¨±ï¼Œä½†é€šéäº†ä¸Šè¿°æ‰€æœ‰éæ¿¾ï¼Œä¸”é•·åº¦é©ä¸­ (2~4å­—ä¸­æ–‡ æˆ– 2~3å–®å­—è‹±æ–‡)
            // é€™å¾ˆæœ‰å¯èƒ½æ˜¯åå­— (é€šå¸¸åå­—æœƒå‡ºç¾åœ¨å‰ 5 è¡Œå…§)
            if (i < 5) {
                 // ç°¡å–®åˆ¤æ–·ï¼šä¸­æ–‡åå­—é€šå¸¸ 2-4 å­—ï¼Œè‹±æ–‡åå­—é€šå¸¸æœ‰ç©ºæ ¼
                 if (line.length >= 2 && line.length <= 15) {
                     return line;
                 }
            }
        }
    }
    return ""; // çœŸçš„æ‰¾ä¸åˆ°
}
    
    function parseOCRResult(text) {
      const lines = text.split('\n').filter(line => line.trim());
      
      // ç°¡å–®çš„è§£æé‚è¼¯
      let name = '';
      let jobTitle = '';
      let department = '';
      let phone = '';
      let fax = '';
      let email = '';
      let company = '';
      let address = '';
      let website = '';
      let taxId = '';
      
      for (let line of lines) {
        line = line.trim();

        // å§“ååµæ¸¬ (å‡è¨­ç¬¬ä¸€è¡Œæˆ–è¼ƒçŸ­çš„è¡Œå¯èƒ½æ˜¯å§“å)
        if (!name && line.length >= 2 && line.length <= 10 && !/\d/.test(line)) {
          name = guessName(lines);
        }
        // Email åµæ¸¬
        const emailMatch = line.match(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/);
        if (emailMatch && !email) {
          email = emailMatch[0];
          continue;
        }
        
        // Website åµæ¸¬
        const websiteMatch = line.match(/(?:https?:\/\/)?(?:www\.)?[a-zA-Z0-9-]+\.[a-zA-Z]{2,}(?:\/[^\s]*)?/);
        if (websiteMatch && !website && !line.includes('@')) {
          website = websiteMatch[0];
          continue;
        }
        
        // é›»è©±åµæ¸¬ (TEL, Phone, é›»è©±ç­‰é—œéµå­—)
        if ((line.includes('TEL') || line.includes('Tel') || line.includes('é›»è©±') || line.includes('Phone')) && !phone) {
          const phoneMatch = line.match(/(?:\+?886[-\s]?)?(?:\(0\d{1,2}\)|0\d{1,2})[-\s]?\d{3,4}[-\s]?\d{4}|\d{10}/);
          if (phoneMatch) {
            phone = phoneMatch[0];
            continue;
          }
        }
        
        // å‚³çœŸåµæ¸¬ (FAX, Fax, å‚³çœŸç­‰é—œéµå­—)
        if ((line.includes('FAX') || line.includes('Fax') || line.includes('å‚³çœŸ')) && !fax) {
          const faxMatch = line.match(/(?:\+?886[-\s]?)?(?:\(0\d{1,2}\)|0\d{1,2})[-\s]?\d{3,4}[-\s]?\d{4}|\d{10}/);
          if (faxMatch) {
            fax = faxMatch[0];
            continue;
          }
        }            
        
        // è·ç¨±åµæ¸¬
        if ((line.includes('Manager') || line.includes('Director') || line.includes('Chief') || 
             line.includes('ç¶“ç†') || line.includes('ç¸½ç›£') || line.includes('é•·') || line.includes('ä¸»ä»»')) && !jobTitle) {
          jobTitle = line;
          continue;
        }
        
        // éƒ¨é–€åµæ¸¬
        if ((line.includes('Department') || line.includes('Dept') || line.includes('éƒ¨é–€') || line.includes('éƒ¨')) && !department) {
          department = line;
          continue;
        }
        
        // åœ°å€åµæ¸¬ (åŒ…å«å¸‚ã€å€ã€è·¯ã€è¡—ç­‰)
        if ((line.includes('å¸‚') || line.includes('å€') || line.includes('è·¯') || line.includes('è¡—') || 
             line.includes('Road') || line.includes('Street') || line.includes('Ave')) && !address && line.length > 10) {
          address = line;
          continue;
        }
        
        // å…¬å¸åç¨±åµæ¸¬
        if ((line.includes('å…¬å¸') || line.includes('æœ‰é™') || line.includes('è‚¡ä»½') || 
             line.includes('Co') || line.includes('Ltd') || line.includes('Inc') ||
             line.includes('Corp')) && !company) {
          company = line;
          continue;
        }
        
        // çµ±ä¸€ç·¨è™Ÿåµæ¸¬ (8ä½æ•¸å­—)
        const taxIdMatch = line.match(/\b\d{8}\b/);
        if (taxIdMatch && !taxId) {
          taxId = taxIdMatch[0];
          continue;
        }
      }
      
      // å¡«å…¥è¡¨å–®
      document.getElementById('nameInput').value = name;
      document.getElementById('jobTitleInput').value = jobTitle;
      document.getElementById('departmentInput').value = department;
      document.getElementById('phoneInput').value = phone;
      document.getElementById('faxInput').value = fax;
      document.getElementById('emailInput').value = email;
      document.getElementById('companyInput').value = company;
      document.getElementById('addressInput').value = address;
      document.getElementById('websiteInput').value = website;
      document.getElementById('taxIdInput').value = taxId;
    }
    
    function uploadNew() {
      if (confirm(translations[currentLanguage].confirmUploadNew)) {
        clearAll();
        document.getElementById('fileInput').click();
      }
    }
    
    function rescan() {
      if (!currentImage) {
        showAlert('error', translations[currentLanguage].alertNoImage);
        return;
      }
      
      if (confirm(translations[currentLanguage].confirmRescan)) {
        performOCR();
      }
    }
    
    function clearAll() {
      currentImage = null;
      currentImageFile = null;
      const t = translations[currentLanguage];
      document.getElementById('previewBox').innerHTML = `
        <div class="preview-placeholder">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
          <p>${t.previewText}</p>
        </div>
      `;
      document.getElementById('nameInput').value = '';
      document.getElementById('jobTitleInput').value = '';
      document.getElementById('departmentInput').value = '';
      document.getElementById('phoneInput').value = '';
      document.getElementById('faxInput').value = '';
      document.getElementById('emailInput').value = '';
      document.getElementById('companyInput').value = '';
      document.getElementById('addressInput').value = '';
      document.getElementById('websiteInput').value = '';
      document.getElementById('taxIdInput').value = '';
      document.getElementById('fileInput').value = '';
      document.getElementById('cameraInput').value = '';
    }
    
    function exportToExcel() {
      const name = document.getElementById('nameInput').value;
      const jobTitle = document.getElementById('jobTitleInput').value;
      const department = document.getElementById('departmentInput').value;
      const phone = document.getElementById('phoneInput').value;
      const fax = document.getElementById('faxInput').value;
      const email = document.getElementById('emailInput').value;
      const company = document.getElementById('companyInput').value;
      const address = document.getElementById('addressInput').value;
      const website = document.getElementById('websiteInput').value;
      const taxId = document.getElementById('taxIdInput').value;
      
      if (!name && !phone && !email && !company && !jobTitle && !department && !fax && !address && !website && !taxId) {
        showAlert('error', translations[currentLanguage].alertFillField);
        return;
      }
      
      // Create workbook
      const wb = XLSX.utils.book_new();
      
      // Get column headers based on current language
      const t = translations[currentLanguage];
      const headers = [
        t.labelName.replace('ğŸ‘¤ ', ''),
        t.labelJobTitle.replace('ğŸ’¼ ', ''),
        t.labelDepartment.replace('ğŸ›ï¸ ', ''),
        t.labelPhone.replace('ğŸ“ ', ''),
        t.labelFax.replace('ğŸ“  ', ''),
        t.labelEmail.replace('âœ‰ï¸ ', ''),
        t.labelCompany.replace('ğŸ¢ ', ''),
        t.labelAddress.replace('ğŸ“ ', ''),
        t.labelWebsite.replace('ğŸŒ ', ''),
        t.labelTaxId.replace('ğŸ”¢ ', '')
      ];
      
      // Create data
      const wsData = [
        headers,
        [name, jobTitle, department, phone, fax, email, company, address, website, taxId]
      ];
      
      // Create worksheet
      const ws = XLSX.utils.aoa_to_sheet(wsData);
      
      // Set column widths
      ws['!cols'] = [
        { wch: 15 },  // Name
        { wch: 20 },  // Job Title
        { wch: 20 },  // Department
        { wch: 20 },  // Phone
        { wch: 20 },  // Fax
        { wch: 30 },  // Email
        { wch: 25 },  // Company
        { wch: 40 },  // Address
        { wch: 30 },  // Website
        { wch: 15 }   // Tax ID
      ];
      
      // Add worksheet to workbook
      XLSX.utils.book_append_sheet(wb, ws, 'Business Card');
      
      // Generate filename
      const timestamp = new Date().toISOString().slice(0, 10).replace(/-/g, '');
      const filename = `BusinessCard_${name || 'Untitled'}_${timestamp}.xlsx`;
      
      // Export file
      XLSX.writeFile(wb, filename);
      
      showAlert('success', translations[currentLanguage].alertExcelDownloaded + filename);
    }
    
    function showAlert(type, message) {
      const alertSuccess = document.getElementById('alertSuccess');
      const alertError = document.getElementById('alertError');
      
      alertSuccess.classList.remove('show');
      alertError.classList.remove('show');
      
      if (type === 'success') {
        alertSuccess.textContent = message;
        alertSuccess.classList.add('show');
        setTimeout(() => alertSuccess.classList.remove('show'), 5000);
      } else {
        alertError.textContent = message;
        alertError.classList.add('show');
        setTimeout(() => alertError.classList.remove('show'), 5000);
      }
    }
  </script>
</body>
</html>
